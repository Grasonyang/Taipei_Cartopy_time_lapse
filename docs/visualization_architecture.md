# è¦–è¦ºåŒ–è…³æœ¬æ¶æ§‹èªªæ˜

## ğŸ“ è…³æœ¬çµ„ç¹”çµæ§‹

### 1. **viz_raw_map.py** - åŸºç¤å°åŒ—å¸‚åœ°åœ–
**ç”¨é€”**: ç¹ªè£½æœ€åŸºç¤çš„ç²‰ç´…è‰²å°åŒ—å¸‚è¡Œæ”¿å€é‚Šç•Œåœ°åœ–

**ç‰¹é»**:
- âœ… ç²‰ç´…è‰²å¡«å…… (`facecolor='pink'`, `alpha=0.3`)
- âœ… æ·ºç°è‰²é‚Šæ¡† (`edgecolor='lightgray'`, `linewidth=0.3`)
- âœ… æ­£æ–¹å½¢ç•«å¸ƒ (14x14 è‹±å‹)
- âœ… æ·ºè‰²ç¶²æ ¼ç·š
- âœ… ä½¿ç”¨ GeoPandas è®€å– Shapefile
- âœ… è‡ªå‹•è½‰æ›åº§æ¨™ç³»çµ± (TWD97 TM2 â†’ WGS84)

**è¼¸å‡º**:
```
outputs/figures/taipei_raw_map.png
```

**åŸ·è¡Œ**:
```bash
python -m src.viz_raw_map
```

---

### 2. **viz_map.py** - äº¤é€šäº‹æ•…åˆ†å¸ƒåœ°åœ–
**ç”¨é€”**: åœ¨åŸºç¤åœ°åœ–ä¸Šç¹ªè£½äº¤é€šäº‹æ•…é»ä½

**ç‰¹é»**:
- âœ… ç¹¼æ‰¿ `viz_raw_map.py` çš„æ‰€æœ‰è¦–è¦ºè¨­å®š
- âœ… åŠ å…¥ A1 äº‹æ•…é»ä½ (ç´…è‰², s=30)
- âœ… åŠ å…¥ A2 äº‹æ•…é»ä½ (æ©˜è‰², s=8)
- âœ… åœ–ä¾‹é¡¯ç¤ºäº‹æ•…çµ±è¨ˆ
- âœ… æ­£æ–¹å½¢ç•«å¸ƒ (14x14 è‹±å‹)

**è¼¸å‡º**:
```
outputs/figures/taipei_accident_map.png
```

**åŸ·è¡Œ**:
```bash
python -m src.viz_map
```

---

### 3. **viz_stats.py** - çµ±è¨ˆåœ–è¡¨
**ç”¨é€”**: ç¹ªè£½äº¤é€šäº‹æ•…çµ±è¨ˆåœ–è¡¨

**è¼¸å‡º**:
- `outputs/figures/district_distribution.png` - è¡Œæ”¿å€åˆ†å¸ƒ
- `outputs/figures/hourly_distribution.png` - æ™‚æ®µåˆ†å¸ƒ

**åŸ·è¡Œ**:
```bash
python -m src.viz_stats
```

---

## ğŸ”§ æŠ€è¡“æ¶æ§‹

### GeoPandas + Cartopy æ•´åˆ

```python
# 1. GeoPandas è®€å– Shapefile
gdf = gpd.read_file('data/taipei/G97_A_CAVLGE_P.shp')

# 2. åº§æ¨™ç³»çµ±è½‰æ›
gdf_wgs84 = gdf.to_crs(epsg=4326)  # TWD97 TM2 â†’ WGS84

# 3. åœ¨ Cartopy åœ°åœ–ä¸Šç¹ªè£½
gdf_wgs84.plot(
    ax=ax,
    transform=ccrs.PlateCarree()  # å‘Šè¨´ Cartopy ä½¿ç”¨ WGS84
)
```

### åº§æ¨™ç³»çµ±èªªæ˜

| ç³»çµ± | EPSG | ç”¨é€” | åº§æ¨™ç¯„åœ |
|------|------|------|----------|
| TWD97 TM2 | 3826 | Shapefile åŸå§‹æ ¼å¼ | (296266~317197, 2761514~2789176) |
| WGS84 | 4326 | Cartopy/ç¶“ç·¯åº¦ | (121.46Â°~121.67Â°E, 24.96Â°~25.21Â°N) |

---

## ğŸ¨ è¦–è¦ºè¨­å®šä¸€è‡´æ€§

æ‰€æœ‰åœ°åœ–è¦–è¦ºåŒ–éƒ½éµå¾ªç›¸åŒçš„åŸºç¤è¨­å®š:

| å±¬æ€§ | è¨­å®šå€¼ |
|------|--------|
| ç•«å¸ƒå¤§å° | 14x14 è‹±å‹ (æ­£æ–¹å½¢) |
| å¡«å……é¡è‰² | `pink` |
| å¡«å……é€æ˜åº¦ | `alpha=0.3` |
| é‚Šæ¡†é¡è‰² | `lightgray` |
| é‚Šæ¡†ç·šå¯¬ | `linewidth=0.3` |
| ç¶²æ ¼ç·šå¯¬ | `linewidth=0.3` |
| ç¶²æ ¼é€æ˜åº¦ | `alpha=0.3` |
| è§£æåº¦ | 300 DPI |

---

## ğŸ“Š è³‡æ–™æµç¨‹

```
Shapefile (EPSG:3826)
    â†“
GeoPandas.read_file()
    â†“
.to_crs(epsg=4326)
    â†“
GeoDataFrame (WGS84)
    â†“
.plot(ax=ax, transform=ccrs.PlateCarree())
    â†“
Cartopy åœ°åœ–
    â†“
PNG åœ–ç‰‡
```

---

## ğŸš€ ä¸‹ä¸€æ­¥: æ™‚é–“åºåˆ—å‹•ç•«

åŸºæ–¼ `viz_raw_map.py` å’Œ `viz_map.py` çš„æ¶æ§‹,æº–å‚™å¯¦ç¾:
- æŒ‰æ™‚é–“é †åºé¡¯ç¤ºäº‹æ•…ç´¯ç©
- ä½¿ç”¨ matplotlib.animation
- è¼¸å‡º MP4/GIF å‹•ç•«

---

**æœ€å¾Œæ›´æ–°**: 2025-11-09
**ç‰ˆæœ¬**: v1.0
